## 請以自己的話解釋 API 是什麼

~~完蛋了...販賣機這個比喻太神了...難以超越~~

自己覺得這篇比較像是自己對 Interface 的理解，不像是那種給初學者看的內容

API 本身我自己認為並沒有很複雜，只是這個詞的應用面真的太廣了。就像天龍這個詞有時候可能是形容詞，可是有時候又在講名詞，應用太廣泛（不是引戰阿，例子好難找）。

簡單說 API 就是：**你照別人給的規定做事情，別人會執行對應的的操作**。

在 web API （也就是大部分前端工程師要會的那類 API），通常是處理 server 端的資料，包含 CRUD： create 建立, read 讀取, Update 更新, Delete 刪除資料，這些處理資料的方式。

API： Appication Programming Interface，應用程式介面，重點在於後面的 Interface。

那 Interface 是啥？中文叫做介面。在化工中有一個東西叫做介面活性劑，簡單說就是可以讓油跟水融合在一起的東西。

油跟水本來是兩種沒辦法相容的液體，當你把油跟水倒在一起，他們之前會有明顯的分層，而我們就會叫那層東西叫做介面

![](https://i.imgur.com/nVlHd7X.jpg)

> 這樣看來，我們會把兩個不同，沒有辦法交互作用的東西（在剛剛化學的情形中是油還有水），它們之間的接觸、交互稱作為介面 （Interface）。

那還有甚麼地方會有介面？ 其實講到介面這個詞我們最常想到的應該是手機吧，但用的是「界面」這個詞。

手機上甚麼東西稱作為「界面」？就是我們平常使用的螢幕阿，我們常常會說這個界面不太好用，或者是聽到 Android 的用戶說 Iphone 的界面我用不習慣。這些我們平常講「界面」到底是啥？

> 人與手機他們之間交互的媒介

就像剛剛的油跟水，人與手機之間也需要有一個媒介。不可能甚麼都不做，甚麼都不表示，手機就知道我們要看影片、要拍照或者是要傳訊息。就算是聽起來很酷的[腦機界面](https://zh.wikipedia.org/wiki/%E8%84%91%E6%9C%BA%E6%8E%A5%E5%8F%A3)，你也有要一個在腦中想的動作。

那我們平常是怎麼操作手機的？很簡單，就是滑手機，不過其實滑手機這件事情我們可以拆解成很多的步驟來看。

### 1. 告訴你如何操作
手機大部分會用螢幕顯示資訊，來告訴你可以要如何操作。例如手機顯示的使用說明，這是比較淺白的利用文字來呈現；又或者是手機上面的 app 的圖示，雖然沒有告訴你這可以按，但是因為過去內化的經驗，又或者是與現實生活對應的設計，讓你知道說：「這個圖案按了就可以打開我要用的 App」。

想像手機一片黑，你要怎麼知道點哪裡可以撥放 Spotify 的音樂？

在這部分，我們可以看成手機向使用者傳遞資訊，傳遞的內容是「甚麼樣的操作，會得到甚麼樣的結果」，比較通俗一點就是教學，但很多時候並不一定是我們平常知道了那種教授使用的指南，有時候會更加直覺或隱晦一點，稱作為「指示」我想會準確一點。

剛剛講的大部分都是利用螢幕來操作，但有時候也不一定是螢幕，現在大家對於智慧型手機的操作都很熟悉了。而且智慧型手機基於人性化的操作，大部分的教學都會直接帶你操作或者是放在手機裡面。但是有時候當我們摸到新的手機、或者是跳到不同系統時，我們還是會看看說明書，這時候傳遞資訊的媒介就不是手機的螢幕，而是紙本的說明書。

更有時候不以文字或圖形來傳達，當我們拿著手機看到按鈕，我們會很直覺的知道擺在一起的兩個按鈕，上面的就是調整音量變大、另一個按鈕就是變小。

扯遠了，談到很多有點像是 UI 的內容。簡單來說，第一個步驟手機會：

> 告訴你可以做甚麼？要怎麼做

### 2. 操作手機
知道了怎麼操作之後，當然就是要操作手機嘛。

使用者要操作手機，可能是利用觸控面板，或者是利用按鈕，有或者很酷的直接使用手勢操作（超想買 Pixel 的）。

手機上面的操作有很多種，像是螢幕的點擊、長按、滑動，或者是按鈕的按壓。但追根究柢這些都是一種操作，只是操作的媒介不一樣，同樣都是操作手機來幫我們完成我們想做的事情。

在這第二個步驟。不論媒介、方式，我們做的都是：

> 操作我們的目標

~~完蛋了這部分篇幅比上面短好多~~

### 3. 得到想要的結果

當你依照手機給的指示做出對應的動作，手機就必須有對應的行動。如果沒有做出對應的行動我們就會稱之為「當機」。~~然後就會把手機拿來敲一敲~~

對應的行動講起來很簡單，其實手機的 CPU 已經不知道執行了多少的程式，必須去解析你的操作，可能是手指停留的時間長度，或者是滑動位移的距離、方向。

現在的觸控螢幕有很多不同的操控方式，單一隻手指可以做到空間（位置）還有時間（速度、停留的時間長短）的變化就很多，如果有多隻手指就有更多的組合了。

~~可惡又扯遠了~~

手機在我們操作背後到底幹了啥不是我們要處理的事情，那些交給硬體工程師還有 app 工程師去處理。最後一個階段，手機對於我們：

> 做了我們想要做的事情

簡單的小整理一下

1. 手機 => 我們：手機告訴我們可以做些甚麼？如何操作
2. 我們 => 手機：我們對手機執行操作
3. 手機 => 我們：手機給予我們對應的動作

當我們把「手機」換成「目標」，「我們」變成「使用者」這兩個比較抽象、廣泛的名詞，我們就可以知道所謂的「界面」到底能幹些啥。

1. 讓目標告訴使用者可以做些甚麼？如何操作
2. 讓使用者對目標執行操作
3. 讓目標能給予使用者對應的動作

舉些其他例子，「手機的觸控螢幕」可以說是很複雜的界面，我們來講個簡單的：檯燈的開關。

開關可以說是最為基礎的界面。

開關這個的界面也只有「開」還有「關」這兩種狀態，我們可以藉由按下開關來操做，也對應到檯燈就只有「燈亮」和「燈暗」兩種狀態（先以最基本的檯燈來看，不要調整亮度或者是色溫）。

開關的構造以及我們對於「燈」的認識告訴了我們開關應該**如何操作**。而當我們按下開關，也就是**操作**「開關」這個「界面」，最後亮起燈，給予我們一開始**想要做的事情**－－開燈。

剛剛講的好像都是在講「界面」這個詞，跟「介面」沒啥關係，不過我自己認為這兩個詞只是字不一樣，是通用的，又或者說用「介面」會更加清楚？

好，剛剛講了那麼多，其實我們還只是在認識介面 Interface 這個概念而已，還沒講到 API 呢。不過當你了解了 Interface 這個概念之後，那我們在看看 API 這個詞。

> "Appication Programming" Interface  
> 
>「應用程式」介面

就像硬體上的介面我們會稱為硬體介面（例如 USB 是隨身碟到電腦的一種硬體介面），那使用者和程式之間的介面我們就會稱為使用者介面（User Interface），人類與機器就稱為人機介面，如果只用腦就可以操作而不使用其他控制方式就稱作腦機介面。

API ，就只是在應用程式上的介面而已，就像這篇長文一開始講的。

> **你照別人給的規定做事情，別人會執行對應的的操作**

那這樣的概念套用在 Appication Programming ，就是兩個不同的程式之間的控制方式，要處理兩程式間的控制當然就是我們工程師啦。那麼 Interface 這個概念在程式上會是甚麼樣的實現方式呢？

### 1. 讓目標告訴使用者可以做些甚麼？如何操作  
我們通常會有一份 Document 可以看有那些東西可以用。
### 2. 讓使用者對目標執行操作
各種不同的領域有不同的操作方式。如果是軟體工程師可能就要使用 OS 提供的 API，前端就要使用 Web API。像是我們在 Coding 時使用的內建函式，或者是下載的 Package 中提供的 function 也是一種 API，所以我們才會看到有時候一些 Package 的 Docs 裡面會寫到 API 這個詞

> 這個是 node.js 的 [Document](https://nodejs.org/en/docs/)，可以看到把他們的 docs 稱作 API Reference Documentation。  
> ![](https://i.imgur.com/bLG3dTh.png)

### 3. 讓目標能給予使用者對應的動作  
也就是得到我們想要的資料，或者是執行我們要的操作。在 OS 可能是在記憶體中儲存或抹去資料。那在 Web API 可能就是從 Server 操作特定的內容。那如果是 Package 的話最直接的就是使用提供的函式。

---

上面就是自己對於 API 的理解， Interface 這個抽象的概念還有很多潛在的意義，像是將實際功能的操作隱藏起來，只提供最表層的操作，這樣就能修改內部的執行而不影響對目標的操作。自己也沒有到非常懂就是了。

難得打長文，平常超級懶得打的...Huli 老師動不動就 10K 字以上目前還難以企及...


## 請找出三個課程沒教的 HTTP status code 並簡單介紹
#### 429 Too Many Requests
這個 status code 的意思很直白，就是你在短時間內送出太多 request 了。  

server 通常會有一個 rate limiting 速率限制，也就是你在一定時間內不能送超過多少個 Request ，這也是挺合理的，每個 Request 都需要電腦的資源去處理，總不能全部花在你身上。

那你如果超過這個 rate limiting 他就會傳送 429 Too Many Requests。

有一個點是 [RFC 6585](https://tools.ietf.org/html/rfc6585#section-4)  裡面規定說當你送出這個 status code 的 response 時有幾條規定：  
1. "建議"詳細說明 rate limiting 的條件，不過沒講怎麼說明，放在 header 或者是 body 應該都可以
2. "選擇性的"在 Header 中加上 Retry-After 來指示說要等多久才可以再送出 request。

好像很沒強制性的感覺... 因為之前好像有其他學員在送出 Request 的時候遇到這個問題，看到這個 status code 特別有印象。

> RFC 是啥？  
> 可能很多人已經知道，但是還是解釋一下，RFC 是用來記錄網際網路協定的文件，想成網路上的法律條文就對了，所有的協定內容都會寫在這上面。


#### 451 Unavailable For Legal Reasons
這是一個很特別的代碼喔，特別到他自己有一份 RFC 文件，和其他的 Status code 不放在一起。

這個 Status code 的意思是因為法律原因，所以我不給你 request 這個內容。[RFC 7725](https://tools.ietf.org/html/rfc7725) 裡面有提到，通常會送出這個 status code 不會是你要求 response 的 server ，會是一些中間的實體，可能像是 DNS ，或者是提供給你網路的網路供應商。

也因為這樣，在 header "必須"要放入"執行封鎖的實體"，聽起來很饒口但其實就是剛剛提到的可能是 DNS 或者是其他東西。

甚麼時候會使用到這個 Status code？ 這跟我們息息相關。

Github 有一個 Repo 「[zhao](https://github.com/programthink/zhao)」 包含了言非言旁糸隹尸匕
的內容，結果中國的政府組織就寫信給 Github 要求刪除。

我大 Github 對於這樣的要求，毫不畏懼的秉持的開源的精神，做出不讓人失望的回應：只要在淪陷區存取這個 Repo 的一律 response 

> 451 Unavailable For Legal Reasons  
> Repository unavailable because of the Chinese Internet Blacklist

不過這個 status 也不一定是因為政治因素啦，也可能是著作權、隱私權或者是依些宗教的因素等等，只要是違反該國法律都有可能會收到這樣的 Status code。

很慶幸生在台灣。

#### 418 I'm a teapot
這個 Status Code 是在 HTTP 協定的其中一個擴充版：HTCPCP 所定義的（你可以想像成小美原本只賣便當，有人擴充了她的經營模式開始賣火鍋）。

你可以使用開頭為 coffee: 的 URL 來送出 HTCPCP 的 request。（我們平常都用 `http://` 開頭的 URL 來送出 http 的 request，HTCPCP 這高貴的 HTTP 擴充版當然需要一個特別的 `coffee://` 作為開頭）

HTCPCP 有和 HTPP 不同的 Request 方式，包含了：
- BREW/POST：要求 HTCPCP Server煮咖啡
- GET：從 Server 獲得咖啡
- WHEN：讓 Server 停止加入牛奶

但是要是你的 server 是個茶壺、或者是手搖杯怎麼辦呢？當然沒辦法拿來泡茶了，只好給你一個 418 I'm a teapot，的 status code。

好，這其實是 1998 年 IETF （寫出剛剛那個 RFC 的一群人）的一個愚人節小玩笑，不過其實很多語言還有網站都有實作這個小彩蛋，像是：https://www.google.com/teapot。

話說他們調侃的 teapot 其實是[電腦圖學](https://zh.wikipedia.org/wiki/%E7%8A%B9%E4%BB%96%E8%8C%B6%E5%A3%B6)的另一個梗...

> 參考資料：  
> https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
> https://zh.wikipedia.org/wiki/HTTP_451  
> https://zh.wikipedia.org/wiki/HTTP狀態碼  
> https://zh.wikipedia.org/wiki/超文字咖啡壺控制協定

## 假設你現在是個餐廳平台，需要提供 API 給別人串接並提供基本的 CRUD 功能，包括：回傳所有餐廳資料、回傳單一餐廳資料、刪除餐廳、新增餐廳、更改餐廳，你的 API 會長什麼樣子？請提供一份 API 文件。

RESTful API 應該會像這樣

baseURL：https://restaPlat

| 說明 | Method | path | 參數 | 範例 |
|--------|--------|------------|----------------------|----------------|
| 獲取所有餐廳資訊 | GET    | /restaurant     | _limit:限制回傳資料數量           | /restaurant?_limit=5 |
| 獲取單一餐廳資訊 | GET    | /restaurant/:id | 無                    | /restaurant/10      |
| 新增餐廳資訊   | POST   | /restaurant     | name: 餐廳名稱 | 古靈精怪              |
| | | | location: 餐廳地點 | 251 新北市淡水區水源街二段 999 號             |
| | | | description: 餐廳介紹 | 一家要開不開的餐廳，但是很好吃              |
| | | | menu: 餐廳菜單 | [<br>"黯然消魂飯"：{<br>"price": "100"<br>"description": "火雲掌手煎的荷包蛋加上用內力震碎肉筋的叉燒，最後再加入洋蔥"<br>},<br>"撒尿牛丸"：{<br>"price": "200"<br>"description": "好吃又好玩"<br>},<br>]              |
| 刪除餐廳   | DELETE   | /restaurant/:id     | 無 | 無              |
| 更改餐廳資訊   | PATCH   | /restaurant/:id     | 同上方新增餐廳資料 | 同上方新增餐廳資料              | 
